<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#1b5e20">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Khet-Bari Pro | Sagar</title>
    <style>
        :root {
            --primary: #1b5e20; --accent: #fbc02d; --danger: #e53935; --info: #0288d1; --bg: #f4f7f4; --card-bg: #ffffff;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background-color: var(--bg); margin: 0; padding: 0; color: #333; overflow-x: hidden;
            scroll-behavior: smooth;
        }

        .header {
            background: linear-gradient(135deg, var(--primary), #2e7d32);
            color: white; padding: 30px 15px 20px; text-align: center;
            border-radius: 0 0 30px 30px; box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
        .header h1 { margin: 0; font-size: 24px; font-weight: 900; letter-spacing: 1px; }
        .header p { margin: 5px 0 0; font-size: 11px; opacity: 0.9; font-weight: bold; color: var(--accent); }

        .container { padding: 15px; padding-bottom: 110px; min-height: 100vh; }

        .card {
            background: var(--card-bg); border-radius: 20px; padding: 20px; margin-bottom: 20px;
            box-shadow: 0 8px 20px rgba(0,0,0,0.06); border: 1px solid rgba(0,0,0,0.05);
        }

        .card-title {
            font-size: 15px; font-weight: 800; color: var(--primary);
            margin-bottom: 15px; display: flex; align-items: center; gap: 8px; border-bottom: 1px solid #eee; padding-bottom: 8px;
        }

        label { font-size: 12px; font-weight: 800; color: #555; display: block; margin-bottom: 5px; margin-top: 10px; }
        input, select {
            width: 100%; padding: 14px; border-radius: 12px; border: 2px solid #edf2f7;
            font-size: 16px; font-weight: 600; box-sizing: border-box; background: #fdfdfd;
        }
        input:focus { border-color: var(--primary); outline: none; background: #fff; }

        .btn {
            border: none; border-radius: 12px; padding: 15px; font-size: 15px; font-weight: 800;
            cursor: pointer; transition: 0.2s; display: flex; align-items: center; justify-content: center;
        }
        .btn-primary { background: var(--primary); color: white; width: 100%; }
        .btn-outline { background: #fff; border: 2px solid var(--danger); color: var(--danger); }
        
        .res-display {
            display: none; margin-top: 15px; padding: 18px; border-radius: 15px;
            background: #f1f8e9; border: 1.5px dashed var(--primary); animation: slideUp 0.4s;
        }
        @keyframes slideUp { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .tile {
            background: #fff; padding: 12px; border-radius: 15px; border: 1px solid #eee;
            text-align: center; box-shadow: 0 2px 8px rgba(0,0,0,0.02);
        }
        .tile-val { display: block; font-size: 18px; font-weight: 900; color: var(--primary); }
        .tile-label { font-size: 10px; color: #888; font-weight: 700; text-transform: uppercase; }

        .nav {
            position: fixed; bottom: 20px; left: 20px; right: 20px;
            background: #fff; height: 65px; border-radius: 20px; display: flex;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2); z-index: 1000;
        }
        .nav-item { flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; color: #bbb; font-size: 11px; font-weight: 800; cursor: pointer; }
        .nav-item.active { color: var(--primary); }
    </style>
</head>
<body>

<div class="header">
    <h1>KHET-BARI PRO</h1>
    <p>PREMIUM SURVEY TOOL ‚Ä¢ BY SAGAR</p>
</div>

<div class="container">
    <div id="p1">
        <div class="card">
            <div class="card-title">üìè ‡§ö‡•å‡§ï‡•ã‡§∞ ‡§ñ‡•á‡§§ (‡§≤‡§Ç‡§¨‡§æ‡§à √ó ‡§ö‡•å‡§°‡§º‡§æ‡§à)</div>
            <input type="number" id="rl" placeholder="‡§≤‡§Ç‡§¨‡§æ‡§à (‡§´‡•Å‡§ü)" style="margin-bottom:10px;">
            <input type="number" id="rw" placeholder="‡§ö‡•å‡§°‡§º‡§æ‡§à (‡§´‡•Å‡§ü)">
            <div style="display:flex; gap:10px; margin-top:15px;">
                <button class="btn btn-primary" onclick="rect()">‡§∞‡§ø‡§ú‡§≤‡•ç‡§ü ‡§¶‡•á‡§ñ‡•á‡§Ç</button>
                <button class="btn btn-outline" onclick="clr(['rl','rw'],'res1')">Reset</button>
            </div>
            <div id="res1" class="res-display"></div>
        </div>

        <div class="card">
            <div class="card-title">üìê ‡§ü‡•á‡§¢‡§º‡§æ ‡§ñ‡•á‡§§ (3/4 ‡§≠‡•Å‡§ú‡§æ‡§è‡§Ç)</div>
            <div class="grid">
                <input type="number" id="s1" placeholder="‡§≠‡•Å‡§ú‡§æ 1">
                <input type="number" id="s2" placeholder="‡§≠‡•Å‡§ú‡§æ 2">
                <input type="number" id="s3" placeholder="‡§≠‡•Å‡§ú‡§æ 3">
                <input type="number" id="s4" placeholder="‡§≠‡•Å‡§ú‡§æ 4">
            </div>
            <div style="display:flex; gap:10px; margin-top:15px;">
                <button class="btn btn-primary" onclick="smart()">‡§π‡§ø‡§∏‡§æ‡§¨ ‡§®‡§ø‡§ï‡§æ‡§≤‡•á‡§Ç</button>
                <button class="btn btn-outline" onclick="clr(['s1','s2','s3','s4'],'res2')">Reset</button>
            </div>
            <div id="res2" class="res-display"></div>
        </div>

        <div class="card">
            <div class="card-title">üìç ‡§≤‡§æ‡§á‡§µ GPS ‡§∏‡§∞‡•ç‡§µ‡•á</div>
            <div style="background:#e3f2fd; padding:15px; border-radius:15px; text-align:center; margin-bottom:15px;">
                <span id="gcount" style="font-size:32px; font-weight:900; color:var(--info);">0</span>
                <div style="font-size:11px; font-weight:bold; color:#555; text-transform:uppercase;">Points Recorded</div>
            </div>
            <div style="display:flex; gap:10px;">
                <button class="btn" style="background:var(--info); color:white; flex:2" onclick="saveG()">‡§ï‡•ã‡§®‡§æ SAVE</button>
                <button class="btn" style="background:#2e7d32; color:white; flex:1" onclick="calcG()">RESULT</button>
            </div>
            <button class="btn btn-outline" style="width:100%; margin-top:10px; border-color:#ccc; color:#777;" onclick="resetG()">GPS Reset</button>
            <div id="res3" class="res-display" style="background:#e1f5fe; border-color:var(--info);"></div>
        </div>
    </div>

    <div id="p2" style="display:none;">
        <div class="card">
            <div class="card-title">üîÑ ‡§è‡§°‡§µ‡§æ‡§Ç‡§∏ ‡§ï‡§®‡§µ‡§∞‡•ç‡§ü‡§∞</div>
            <label>‡§≤‡§ó‡•ç‡§ó‡•Ä ‡§ï‡§æ ‡§∏‡§æ‡§á‡§ú (‡§π‡§æ‡§• ‡§Æ‡•á‡§Ç)</label>
            <select id="lgi" onchange="cnv()">
                <option value="4">4 ‡§π‡§æ‡§•</option>
                <option value="4.5">4.5 ‡§π‡§æ‡§•</option>
                <option value="5">5 ‡§π‡§æ‡§•</option>
                <option value="5.5">5.5 ‡§π‡§æ‡§•</option>
                <option value="6">6 ‡§π‡§æ‡§•</option>
                <option value="6.5">6.5 ‡§π‡§æ‡§•</option>
                <option value="7">7 ‡§π‡§æ‡§•</option>
                <option value="8">8 ‡§π‡§æ‡§•</option>
                <option value="8.5" selected>8.5 ‡§π‡§æ‡§•</option>
                <option value="9">9 ‡§π‡§æ‡§•</option>
                <option value="10">10 ‡§π‡§æ‡§•</option>
                <option value="11">11 ‡§π‡§æ‡§•</option>
                <option value="12">12 ‡§π‡§æ‡§•</option>
            </select>

            <label>‡§á‡§ï‡§æ‡§à ‡§ö‡•Å‡§®‡•á‡§Ç</label>
            <select id="ut" onchange="cnv()">
                <option value="sqft">‡§µ‡§∞‡•ç‡§ó ‡§´‡•Å‡§ü (Sq.Ft)</option>
                <option value="dismil">‡§°‡§ø‡§∏‡§Æ‡•Ä‡§≤ (Decimal)</option>
                <option value="dhurki">‡§ß‡•Å‡§∞‡§ï‡•Ä</option>
                <option value="dhur">‡§ß‡•Å‡§∞</option>
                <option value="katha">‡§ï‡§ü‡•ç‡§†‡§æ</option>
                <option value="bigha">‡§¨‡•Ä‡§ò‡§æ</option>
                <option value="acre">‡§è‡§ï‡§°‡§º</option>
                <option value="hectare">‡§π‡•á‡§ï‡•ç‡§ü‡•á‡§Ø‡§∞</option>
                <option value="sqmeter">‡§µ‡§∞‡•ç‡§ó ‡§Æ‡•Ä‡§ü‡§∞</option>
                <option value="sqyard">‡§µ‡§∞‡•ç‡§ó ‡§ó‡§ú‡§º</option>
            </select>
            
            <label>‡§∏‡§Ç‡§ñ‡•ç‡§Ø‡§æ ‡§≤‡§ø‡§ñ‡•á‡§Ç</label>
            <input type="number" id="ui" placeholder="‡§Ø‡§π‡§æ‡§Å ‡§ü‡§æ‡§á‡§™ ‡§ï‡§∞‡•á‡§Ç..." oninput="cnv()">
            
            <button class="btn btn-outline" style="width:100%; margin-top:15px; border-color:var(--danger); color:var(--danger);" onclick="resetP2()">Reset (‡§∏‡§æ‡§´‡§º ‡§ï‡§∞‡•á‡§Ç)</button>
        </div>

        <div class="grid">
            <div class="tile" style="grid-column: span 2; background:#fffde7; border-color:var(--accent);">
                <span class="tile-label" style="color:#b8860b;">‡§°‡§ø‡§∏‡§Æ‡•Ä‡§≤ (DECIMAL)</span>
                <span class="tile-val" id="oDismil" style="color:#b8860b; font-size:24px;">0</span>
            </div>
            <div class="tile"><span class="tile-label">‡§µ‡§∞‡•ç‡§ó ‡§´‡•Å‡§ü</span><span class="tile-val" id="oSqft">0</span></div>
            <div class="tile"><span class="tile-label">‡§ß‡•Å‡§∞</span><span class="tile-val" id="oDhur">0</span></div>
            <div class="tile"><span class="tile-label">‡§ï‡§ü‡•ç‡§†‡§æ</span><span class="tile-val" id="oKatha">0</span></div>
            <div class="tile"><span class="tile-label">‡§¨‡•Ä‡§ò‡§æ</span><span class="tile-val" id="oBigha">0</span></div>
            <div class="tile"><span class="tile-label">‡§ß‡•Å‡§∞‡§ï‡•Ä</span><span class="tile-val" id="oDhurki">0</span></div>
            <div class="tile"><span class="tile-label">‡§è‡§ï‡§°‡§º</span><span class="tile-val" id="oAcre">0</span></div>
            <div class="tile"><span class="tile-label">‡§π‡•á‡§ï‡•ç‡§ü‡•á‡§Ø‡§∞</span><span class="tile-val" id="oHect">0</span></div>
            <div class="tile"><span class="tile-label">‡§µ‡§∞‡•ç‡§ó ‡§ó‡§ú‡§º</span><span class="tile-val" id="oGaj">0</span></div>
            <div class="tile"><span class="tile-label">‡§µ‡§∞‡•ç‡§ó ‡§Æ‡•Ä‡§ü‡§∞</span><span class="tile-val" id="oMeter">0</span></div>
        </div>
        <button class="btn" style="background:#25D366; color:white; width:100%; margin-top:20px; box-shadow:0 4px 12px rgba(37,211,102,0.3);" onclick="share()">üü¢ WhatsApp ‡§∂‡•á‡§Ø‡§∞ ‡§ï‡§∞‡•á‡§Ç</button>
    </div>
</div>

<div class="nav">
    <div class="nav-item active" id="n1" onclick="tab('p1','n1')"><span>üìè</span>‡§®‡§æ‡§™-‡§§‡•å‡§≤</div>
    <div class="nav-item" id="n2" onclick="tab('p2','n2')"><span>üîÑ</span>‡§ï‡§®‡§µ‡§∞‡•ç‡§ü‡§∞</div>
</div>

<script>
    function tab(p, n) {
        // Scroll to top to avoid page jumping
        window.scrollTo(0,0);
        document.getElementById('p1').style.display = p==='p1'?'block':'none';
        document.getElementById('p2').style.display = p==='p2'?'block':'none';
        document.getElementById('n1').classList.remove('active');
        document.getElementById('n2').classList.remove('active');
        document.getElementById(n).classList.add('active');
    }

    function clr(ids, res) { 
        ids.forEach(i=>document.getElementById(i).value=''); 
        document.getElementById(res).style.display='none'; 
    }

    function resetP2() {
        document.getElementById('ui').value = '';
        cnv();
    }

    function rect() {
        let l=parseFloat(document.getElementById('rl').value), w=parseFloat(document.getElementById('rw').value);
        if(l && w) {
            let a=l*w, r=document.getElementById('res1'); r.style.display='block';
            r.innerHTML=`‡§è‡§∞‡§ø‡§Ø‡§æ: <b>${a.toLocaleString()}</b> Sq.Ft<br>‡§°‡§ø‡§∏‡§Æ‡•Ä‡§≤: <b>${(a/435.6).toFixed(3)}</b><br><small>‡§¨‡§æ‡§â‡§Ç‡§°‡•ç‡§∞‡•Ä: ${2*(l+w)} ‡§´‡•Å‡§ü</small>`;
        }
    }

    function smart() {
        let a=parseFloat(document.getElementById('s1').value), b=parseFloat(document.getElementById('s2').value),
            c=parseFloat(document.getElementById('s3').value), d=parseFloat(document.getElementById('s4').value)||0;
        let area = 0;
        if(a && b && c && d===0) { let s=(a+b+c)/2; area=Math.sqrt(s*(s-a)*(s-b)*(s-c)); }
        else if(a && b && c && d) { area=((a+c)/2)*((b+d)/2); }
        if(area>0) {
            let r=document.getElementById('res2'); r.style.display='block';
            r.innerHTML=`Area: <b>${area.toFixed(2)}</b> Sq.Ft<br>‡§°‡§ø‡§∏‡§Æ‡•Ä‡§≤: <b>${(area/435.6).toFixed(3)}</b>`;
        }
    }

    let pts=[];
    function saveG() {
        navigator.geolocation.getCurrentPosition(p=>{
            pts.push({lat:p.coords.latitude, lon:p.coords.longitude});
            document.getElementById('gcount').innerText=pts.length;
        }, e=>alert("GPS Error! Location ON ‡§ï‡§∞‡•á‡§Ç‡•§"), {enableHighAccuracy:true});
    }

    function calcG() {
        if(pts.length<3) return alert("3 ‡§ï‡•ã‡§®‡•á ‡§ú‡§º‡§∞‡•Ç‡§∞‡•Ä ‡§π‡•à‡§Ç!");
        let a=0;
        for(let i=0; i<pts.length; i++){
            let j=(i+1)%pts.length;
            let x1=pts[i].lon*111320*Math.cos(pts[i].lat*Math.PI/180), y1=pts[i].lat*111320;
            let x2=pts[j].lon*111320*Math.cos(pts[j].lat*Math.PI/180), y2=pts[j].lat*111320;
            a+=(x1*y2)-(x2*y1);
        }
        a=(Math.abs(a)/2)*10.7639;
        let r=document.getElementById('res3'); r.style.display='block';
        r.innerHTML=`GPS ‡§è‡§∞‡§ø‡§Ø‡§æ: <b>${a.toFixed(2)}</b> Sq.Ft<br>‡§°‡§ø‡§∏‡§Æ‡•Ä‡§≤: <b>${(a/435.6).toFixed(3)}</b>`;
    }
    function resetG() { pts=[]; document.getElementById('gcount').innerText='0'; document.getElementById('res3').style.display='none'; }

    function cnv() {
        let laggi=parseFloat(document.getElementById('lgi').value), val=parseFloat(document.getElementById('ui').value)||0,
            ut=document.getElementById('ut').value, dhur=Math.pow(laggi*1.5, 2), sqft=0;
        
        if(ut==='sqft') sqft=val;
        else if(ut==='dismil') sqft=val*435.6;
        else if(ut==='dhurki') sqft=val*(dhur/20);
        else if(ut==='dhur') sqft=val*dhur;
        else if(ut==='katha') sqft=val*dhur*20;
        else if(ut==='bigha') sqft=val*dhur*400;
        else if(ut==='acre') sqft=val*43560;
        else if(ut==='hectare') sqft=val*107639;
        else if(ut==='sqmeter') sqft=val*10.764;
        else if(ut==='sqyard') sqft=val*9;

        document.getElementById('oSqft').innerText=sqft.toLocaleString(undefined,{maximumFractionDigits:1});
        document.getElementById('oDismil').innerText=(sqft/435.6).toFixed(3);
        document.getElementById('oKatha').innerText=(sqft/(dhur*20)).toFixed(2);
        document.getElementById('oDhur').innerText=(sqft/dhur).toFixed(2);
        document.getElementById('oDhurki').innerText=(sqft/(dhur/20)).toFixed(1);
        document.getElementById('oBigha').innerText=(sqft/(dhur*400)).toFixed(2);
        document.getElementById('oAcre').innerText=(sqft/43560).toFixed(4);
        document.getElementById('oHect').innerText=(sqft/107639).toFixed(4);
        document.getElementById('oGaj').innerText=(sqft/9).toFixed(1);
        document.getElementById('oMeter').innerText=(sqft/10.764).toFixed(1);
    }

    function share() { window.open("https://api.whatsapp.com/send?text="+encodeURIComponent("‡§ñ‡•á‡§§-‡§¨‡§æ‡§∞‡•Ä ‡§™‡•ç‡§∞‡•ã ‡§ï‡•à‡§≤‡§ï‡•Å‡§≤‡•á‡§ü‡§∞: "+window.location.href)); }
    
  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('./sw.js')
      .then(() => console.log("Khet-Bari Pro Ready!"))
      .catch(err => console.log("SW Error", err));
  }
</script>

</body>
</html>
